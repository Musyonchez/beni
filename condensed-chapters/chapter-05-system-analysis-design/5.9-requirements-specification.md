# 5.9 Requirements Specification

The requirements specification formalizes all functional and non-functional requirements guiding system development and providing measurable criteria for acceptance testing. Requirements are categorized, assigned unique identifiers, and prioritized using the MoSCoW method (Must have, Should have, Could have, Won't have).

## Functional Requirements

Functional requirements define specific behaviors and features the system must provide.

### Authentication and User Management (FR1-FR5)

**FR1: User Registration** (Must Have) - Allow new users to register with name, email, phone, and password. Validate email/phone formats, check uniqueness, send verification email, create user record with zero initial loyalty points.

**FR2: User Login** (Must Have) - Authenticate users via email/password using Firebase Authentication. Generate JWT tokens, persist login state, limit failed attempts to 3 before 15-minute lockout.

**FR3: Password Reset** (Must Have) - Provide password reset via email with secure link expiring after 1 hour.

**FR4: Profile Management** (Should Have) - Allow users to view/edit profile (name, phone, photo). Prevent email changes. Require current password for password changes.

**FR5: Session Management** (Must Have) - Automatically logout after 30 days inactivity. Provide manual logout clearing session tokens.

### Menu Browsing and Discovery (FR6-FR11)

**FR6: Menu Display** (Must Have) - Display all available menu items with name, description, image, price, preparation time. Organize by categories. Mark unavailable items clearly.

**FR7: Menu Search** (Should Have) - Provide keyword search across item names/descriptions with real-time results.

**FR8: Category Filtering** (Must Have) - Allow filtering by category using horizontal scrolling chips. Display item count per category.

**FR9: Item Detail View** (Must Have) - Display detailed information including full image, description, nutritional info, allergens, preparation time, availability.

**FR10: Popular Items** (Should Have) - Display top 5 most frequently ordered items on home screen.

**FR11: Item Favorites** (Could Have) - Allow users to mark items as favorites for quick access.

### Shopping Cart and Ordering (FR12-FR18)

**FR12: Add to Cart** (Must Have) - Allow adding items with quantity specification. Support quantity adjustments. Prevent adding unavailable items. Calculate cart subtotal in real-time.

**FR13: Cart Management** (Must Have) - View cart contents, modify quantities, remove items, clear cart. Persist cart across restarts. Auto-remove items marked unavailable.

**FR14: Loyalty Points Redemption** (Must Have) - Display available points during checkout. Offer redemption (100 points = 50 KES discount) in 100-point increments. Apply discount and reserve points pending payment.

**FR15: Delivery Preferences** (Should Have) - Specify pickup time (now, 30 min, 1 hour, custom). Accept special instructions (max 500 characters).

**FR16: Order Review** (Must Have) - Display complete order summary before payment including items, quantities, prices, subtotal, discounts, final total. Require explicit confirmation.

**FR17: Order Placement** (Must Have) - Create order record in Firestore with status "Pending Payment". Generate unique order ID. Store all details including timestamp, user info, preferences.

**FR18: Reordering** (Could Have) - Allow one-tap reorder of previous orders. Verify all items remain available.

### Payment Processing (FR19-FR22)

**FR19: M-Pesa Integration** (Must Have) - Integrate M-Pesa Daraja API. Initiate STK Push to user's phone. Support payments from 10 KES to 50,000 KES.

**FR20: Payment Verification** (Must Have) - Verify payment via M-Pesa callback. Validate callback authenticity. Update order status to "Payment Confirmed" and release reserved points.

**FR21: Payment Timeout** (Must Have) - Auto-cancel order if payment doesn't complete within 5 minutes. Release reserved points. Notify user.

**FR22: Payment Receipt** (Should Have) - Display confirmation with M-Pesa transaction ID and receipt number. Store payment records.

### Order Tracking (FR23-FR26)

**FR23: Real-Time Status Updates** (Must Have) - Provide real-time tracking using Firestore listeners. Display progress (Payment Confirmed → Preparing → Ready → Completed) with visual indicator and estimated ready time.

**FR24: Push Notifications** (Must Have) - Send notifications when status changes, especially when ready for pickup. Include order number and new status.

**FR25: Order History** (Must Have) - Maintain complete order history. Display past orders chronologically with date, items, total, status. Allow viewing detailed information.

**FR26: Order Cancellation** (Should Have) - Allow cancellation if status is "Pending Payment" or "Payment Confirmed" (not yet preparing). Refund payment if applicable. Release reserved points.

### Loyalty Program (FR27-FR29)

**FR27: Points Earning** (Must Have) - Auto-calculate and award loyalty points upon completion. Award 1 point per 100 KES spent (rounded down). Apply promotional multipliers (2x, 3x) when active. Enforce minimum 200 KES for points eligibility.

**FR28: Points Balance Display** (Must Have) - Display current points balance on profile and during checkout. Show redemption value (100 points = 50 KES).

**FR29: Points Transaction History** (Should Have) - Maintain complete transaction history showing earned/redeemed points with dates, amounts, source orders, and running balance.

### Administrative Functions (FR30-FR35)

**FR30: Order Queue Management** (Must Have) - Display all active orders chronologically with customer details, items, elapsed time. Auto-refresh every 30 seconds. Play sound for new orders.

**FR31: Status Updates** (Must Have) - Enable single-click status updates. Trigger immediate Firestore updates and push notifications.

**FR32: Menu Item Management** (Must Have) - Create, edit, delete menu items. Support image upload. Require confirmation before deleting items with order history.

**FR33: Inventory Management** (Must Have) - Mark items available/unavailable. Take effect immediately.

**FR34: Analytics Dashboard** (Should Have) - Access analytics showing order counts, revenue totals, popular items, peak hours. Display KPI cards and visualizations.

**FR35: User Management** (Could Have) - View registered users, search by name/email, deactivate accounts. Allow manual loyalty points adjustments with audit logging.

---

## Non-Functional Requirements

### Performance (NFR1-NFR5)

NFR1: **App Launch** - Launch to first screen in \<3 seconds  
NFR2: **Menu Loading** - Load menu within 2 seconds (3G+)  
NFR3: **Search Response** - Display results within 500ms  
NFR4: **Payment Processing** - STK Push complete within 10 seconds, total payment within 60 seconds  
NFR5: **Real-Time Updates** - Propagate status updates within 2 seconds  

### Scalability (NFR6-NFR7)

NFR6: **Concurrent Users** - Support minimum 100 concurrent users without degradation  
NFR7: **Database Performance** - Maintain sub-second queries with 10,000+ items, 50,000+ orders, 5,000+ users  

### Availability and Reliability (NFR8-NFR9)

NFR8: **System Uptime** - Achieve 99.5% uptime during cafeteria hours (7 AM-8 PM, Mon-Fri)  
NFR9: **Offline Functionality** - Allow menu browsing and cart preparation while offline with clear indicators  

### Security (NFR10-NFR13)

NFR10: **Data Encryption** - Use HTTPS/TLS 1.2+, bcrypt password hashing  
NFR11: **Authentication Security** - 30-day token expiration, 3-failure account lockout, 1-hour password reset expiration  
NFR12: **Payment Security** - Never store M-Pesa PINs. Verify callback authenticity  
NFR13: **Data Privacy** - Comply with GDPR and Kenya Data Protection Act. Support data export and deletion  

### Usability (NFR14-NFR16)

NFR14: **UI Responsiveness** - Maximum 100ms delay between input and feedback  
NFR15: **Accessibility** - 4.5:1 contrast ratio (WCAG AA). Minimum 44×44pt touch targets. Screen reader support  
NFR16: **Learning Curve** - First-time users complete order within 3 minutes without instructions  

### Compatibility (NFR17-NFR18)

NFR17: **Mobile Platform** - Support Android 8.0+, iOS 12+. Screen sizes 4.7"-7"  
NFR18: **Web Browser** - Support latest Chrome, Firefox, Safari, Edge  

---

**Word Count**: ~1,100 words (condensed from ~2,322 words)  
**Status**: ✅ Condensed (53% reduction)
